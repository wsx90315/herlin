!function(e,t){var n=e.jQuery;n&&t(e,e.document,n)}(window,function(e,t,n){var r=function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},i=function(){function e(e){this.id=e,this.$ele=n("#"+this.id),this.$originEle=n(o.tag[this.id])}var r=e.prototype;return r.beforeParse=function(e){return e},r.bindEvent=function(){var e=this,n=t.getElementById(this.id);if(null!=n)for(var r=0,i=n.attributes.length;i>r;r++){var a=n.attributes[r];if(0==a.name.indexOf("data-gk-")){var o=a.name.substring(8);this.$ele.unbind(o),this.$ele.bind(o,e["on"+o])}}},r.destroy=function(){delete o.tag[this.id],this.id=null,this.$originEle=null,this.$ele.removeData(),this.$ele.unbind(),this.$ele=null},e}(),a=function(){var e={},r=t.createElement("div");return e.safeDocumentFrag=t.createDocumentFragment(),e.safeDocumentFrag.appendChild(r),e.createElement=function(r){n.support.leadingWhitespace||(t.createElement(r),e.safeDocumentFrag.createElement(r))},e.createDIVWrapper=function(e){var t;return r.innerHTML="<div>"+e+"</div>",r.removeChild(t=r.firstChild),t},e.cloneNode=function(e){var t;return n.support.leadingWhitespace?t=e.cloneNode(!0):(r.innerHTML=e.outerHTML,r.removeChild(t=r.firstChild)),t},e.replaceElement=function(e,t){for(var n=e.parentNode;null!=t;){var r=t.nextSibling;n.insertBefore(t,e),t=r}n.removeChild(e)},e.toElement=function(t){var n=e.createDIVWrapper(t);return n.firstChild},e.innerHTML=function(e){var t="",n=e;if(null!=n){if(""!==e.innerHTML)return e.innerHTML;for(;n.nextSibling;)if(n=n.nextSibling,3===n.nodeType)t+=n.nodeValue.trim(),n.nodeValue="";else if(1===n.nodeType)break}return t},e}(),o=function(){var e={CLASS:"use",tag:{},PREFIX:"_gk_src_"};return e.replaceWith=function(t,r){if("undefined"==typeof r)return null;var i,o,s,u,l,p=a.cloneNode(c.customTags[t]),f=n(p),d=f.attr(this.CLASS)||"WebComponent",g=f.html();g=c.unDecorateSpecialAttr(g),o="undefined"==typeof r.id||""===r.id?r.id=c.getGenId():r.id,i="$.gk.com('"+o+"' , new $.gk.components['"+d+"']('"+o+"'));",c.eventStore.script.push(i),s=a.innerHTML(r),e.tag[o]=n(r).clone().wrap("<div></div>").parent().html().trim(),g=g.replace(c.content,s),g=n.gk.components[t].prototype.beforeParse(g);var m=[],h={},v={};return n.each(r.attributes,function(e,t){0==t.nodeName.indexOf("on")&&m.push([t.nodeName,t.nodeValue]),h[t.nodeName]=t.nodeValue;var n=new RegExp("{{"+t.nodeName+"}}","gi");null!==g.match(n)?g=g.replace(n,t.nodeValue):v[t.nodeName]=t.nodeValue}),u=a.toElement(g),l=n(u),n.each(m,function(e,t){l.attr(t[0],t[1])}),n.each(h,function(t,n){l.data(e.PREFIX+t,n)}),n.each(v,function(e,t){"undefined"==typeof l.attr(e)&&/is/.test(e)===!1&&l.attr(e,t)}),l.addClass("gk-component-"+d.toLowerCase()),a.replaceElement(r,u),u},e}(),c=function(){var e={},t="style|class",r=new RegExp("\\s+("+t+")(?==['\"].*?['\"]\\s?)","gi"),i=/\s+(?:data-gksa-(.*?))(?==['"].*?['"])/gi;return e.serial=0,e.customTags={},e.content=new RegExp("<contents*>S*</content>","ig"),e.DATAKEY="_gk_",e.genIdPrefix="_gk_gen_",e.eventStore=[],e.eventStore.script=[],e.decorateSpecialAttr=function(e){return e=e.replace(r," data-gksa-$1"),r.lastIndex=0,e},e.unDecorateSpecialAttr=function(e){return e=e.replace(i," $1"),i.lastIndex=0,e},e.getGenId=function(){return this.genIdPrefix+this.serial++},e.isComponent=function(t){return e.customTags[t.toUpperCase()]},e.enhance=function(e){n(e).each(function(t,r){var i=n(r);"*[is]"===e&&(i=i.parent());var a=i.html();a="BODY"===i.prop("tagName")?a.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""):a;var o=n.gk.toHTML(a);o!==a&&i.html(o)})},e.process=function(t){var r=n.type(t);if("null"!==r&&"undefined"!==r){var i=t.nodeName.toUpperCase();if("#"!==i.charAt(0)&&null!=t.getAttribute("is")&&(i=t.getAttribute("is").toUpperCase()),e.isComponent(i))e.process(o.replaceWith(i,t));else if(t.firstChild)e.process(t.firstChild);else if(t.nextSibling)e.process(t.nextSibling);else if(t.parentNode&&t.parentNode.parentNode){for(t=t.parentNode;null==t.nextSibling;){if(!t.parentNode)return;t=t.parentNode}e.process(t.nextSibling)}}},e}();n.gk={version:"0.6",__inner:{TagLibrary:c,CustomTag:o},components:{WebComponent:i},createTag:function(e){for(var t in e)e.hasOwnProperty(t)&&a.createElement(e[t].replace(/\S*\//g,""))},init:function(){c.enhance("*[gk-app]"),c.enhance("*[is]"),n(t).triggerHandler("gkComponentsReady")},toHTML:function(e){var t,n,r=a.createDIVWrapper(e);return c.process(r),t=(c.eventStore.script||[]).join(" "),n=t.length>0?r.innerHTML+"<script>"+t+"</script>":r.innerHTML,c.eventStore.script=[],n.replace(/(\s(?!(data-gk-))[\w-]+=['"]\{\{[^\{\}]+\}\}['"])/g,"")},registry:function(e,t){if(null!=e&&"string"==typeof e){a.createElement(e.replace(/\S*\//g,""));var o,s;"function"==typeof t?o=t():"object"==typeof t&&t.constructor===Object&&(o=t),o.name=e.toUpperCase(),s="<gk:view use='"+o.name+"'>"+o.template+"</gk:view>",s=c.decorateSpecialAttr(s),c.customTags[o.name]=n(s)[0];var u=function(e){i.call(this,e),o.script&&o.script.call(this),this.bindEvent.call(this)};r(u,i),o.beforeParse&&(u.prototype.beforeParse=o.beforeParse),u.prototype.template=o.template,n.gk.components[o.name]=u}},com:function(e,t){n("#"+e).data(c.DATAKEY,t),t.init&&t.init()}},n.fn.gk=function(e){if(0==arguments.length)return n(this).data(c.DATAKEY);var t=Array.prototype.slice.call(arguments,1),r=null;return this.each(function(i,a){var o=n(a).data(c.DATAKEY);if(o instanceof Object&&"function"===n.type(o[e])){var s=o[e].apply(o,t);0==i&&(r=s)}}),r},"function"==typeof define?(define("jquery",function(){return n}),define("gk",["jquery"],function(){return n.gk})):(e.define=function(){n.gk.registry.apply(this,arguments)},n(t).ready(function(){n.gk.init()}))});